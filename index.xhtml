<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>FI-Content Demo</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

        <!-- jQuery simplified Web/JavaScript development -->
        <script type="text/javascript" src="externals/jquery/jquery-1.6.1.js"></script>

        <!-- KataJS simplifies development of the Sirikata ObjectHost in the browser -->
        <script type="text/javascript" src="externals/katajs/katajs/core/Core.js"></script>

        <!-- configuration -->
        <script type="text/javascript"><![CDATA[
            //var spaceServer = "sirikata://" + window.location.host + ":7777/";
            //var spaceServer = "sirikata://yellow.cg.uni-saarland.de:7777/";
            var spaceServer = "loop://localhost:7777/";
            var avatarMesh = "cdn/empty.xml3d";
            var worldMesh = "cdn/simpleWorld.xml3d";
            var kata_base_offset = "../../"; // offset from the externals/katajs/ back to the root dir

            // configure Web Workers
            Kata.WEB_WORKERS_ENABLED = false;
            //Kata.bootstrapWorker = window.location.href + "/boostrapWorker.js";
        ]]></script>

        <!-- main script -->
        <script type="text/javascript"><![CDATA[
            $(window).load(function() {
                Kata.require([
                    'katajs/oh/MainThread.js', // to create MainThread object
                    'katajs/gfx/xml3dgfx.js', // XML3D Graphics Simulation
                    'katajs/oh/plugins/sirikata/SirikataSpaceConnection.js', // to use sirikata://.../ protocol
                    'katajs/oh/plugins/loop/LoopbackSpaceConnection.js', // to use loop://.../ protocol
                ], function() {
                    Kata.GraphicsSimulation.initializeDriver("XML3D", worldMesh, function() {
                        kata = new Kata.MainThread(
                            kata_base_offset + "scripts/AvatarScript.js",
                            "FIContent.AvatarScript",
                            {
                                space: spaceServer,
                                loc: {
                                    scale: [0, 0, 0, 1],
                                    pos: [0, 0, 0]
                                },
                                visual: {
                                    mesh: avatarMesh
                                }
                            }
                        );
                        graphics = new Kata.GraphicsSimulation("XML3D", kata.getChannel(), document.getElementById("view"));
                    });
                });
            });
        ]]></script>

        <!-- Load style for the viewer interface -->
        <link type="text/css" href="style/style-common.css" rel="stylesheet" media="all" />
        <link type="text/css" href="style/style-viewer.css" rel="stylesheet" media="all" />
    </head>
    <body>
        <div id="view" />
    </body>
</html>
